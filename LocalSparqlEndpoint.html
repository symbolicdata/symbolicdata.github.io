<h3 id="goal-of-this-page">Goal of this page</h3>
<p>To operate SymbolicData on a local site requires access to the data via a web server at localhost and a Sparql endpoint.</p>
<p>On this page we describe how to set up your own Sparql endpoint at <a href="http://localhost:8890/sparql">http://localhost:8890/sparql</a> based on Apache running under a recent Linux Debian Ubuntu distribution.</p>
<ul>
<li>Tried with Debian GNU/Linux 7.0, Ubuntu 12.04.2 LTS, and Apache/2.2.22 (Debian)</li>
</ul>
<h3 id="preliminary-remarks">Preliminary Remarks</h3>
<p>There are plenty of RDF stores based on MySQL databases. Much of them are well suited for serving SymbolicData Data, too (we successfully used an <a href="https://github.com/semsol/arc2/wiki">arc2 based store</a>).</p>
<p>Here we describe how to install an RDF infrastructure based on the more powerful RDF Engine <a href="http://virtuoso.openlinksw.com">Virtuoso</a> and (optional) the RDF Editor Tool <a href="http://aksw.org/Projects/OntoWiki.html">Ontowiki</a>.</p>
<ul>
<li>Virtuoso is a commercial Database store of <em>Openlink Software</em> specially designed to serve huge RDF data that comes with a built in Sparql endpoint. We recommend to use the Virtuoso Open Source Distribution (VOS) bundled with Debian.</li>
<li>Ontowiki is a performant Open Source RDF Editing Tool developed by the ASWK group at the University of Leipzig. It can directly be installed from the Ontowiki git Repo and easily configured to run with Virtuoso.</li>
</ul>
<p>It may be necessary to <strong>adjust the apache settings</strong> in <code>etc/php5/apache2/php.ini</code> to be able to upload large knowledge bases:</p>
<p><code> post_max_size = 128M</code> <code> short_open_tag = off</code> <code> memory_limit = 1280M</code> <code> upload_max_filesize = 128M</code></p>
<p>Caveat: In any case it is a good advice to upload larger RDF graphs via the Virtuoso console (as described below).</p>
<p>Moreover, mod_rewrite has to be activated since OntoWiki heavily uses URI Rewriting to comply with the Linked Open Data Standards.</p>
<h3 id="install-the-virtuoso-engine">Install the Virtuoso engine</h3>
<p>The virtuoso engine can easily be installed with the single command</p>
<p>sudo aptitude install virtuoso-opensource</p>
<p>For security reasons during installation you will be asked for a password for the db users 'dba' and 'dav' (default: dba). The password should match the regex [a-zA-Z0-9]+, i.e., have only letters and ciphers.</p>
<p>For details see <a href="http://virtuoso.openlinksw.com/dataspace/doc/dav/wiki/Main/VOSUbuntuNotes">http://virtuoso.openlinksw.com/dataspace/doc/dav/wiki/Main/VOSUbuntuNotes</a></p>
<p>The executables provided (in the virtuoso-opensource-6.1-bin package) are:</p>
<ul>
<li>/usr/bin/isql-vt -- command-line database-access tool, iSQL</li>
<li>/usr/bin/isqlw-vt -- Unicode-enabled iSQL</li>
<li>/usr/bin/virt_mail -- SMTP delivery agent for incoming mail</li>
<li>/usr/bin/virtuoso-t -- Main daemon executable</li>
</ul>
<p>At server start time a Virtuoso database is started with configuration read from /etc/virtuoso-opensource-6.1/virtuoso.ini. The default settings point to</p>
<ul>
<li>/var/lib/virtuoso-opensource-6.1/db/ as the directory where all data and logging information resides</li>
<li>the DB server port 1111 to be used by the console command</li>
</ul>
<p><code>isql-vt 1111 dba YourDBPassword</code></p>
<p>if the daemon is running.</p>
<ul>
<li>the HTTP server port 8890 to be used as <a href="http://localhost:8890">http://localhost:8890</a> - it allows to manage the database via the conductor, a web interface similar to phpmyadmin or so - and the Sparql endpoint at <a href="http://localhost:8890/sparql">http://localhost:8890/sparql</a>.</li>
</ul>
<h3 id="optional-create-a-new-virtuoso-database-and-start-operation">(Optional) Create a new Virtuoso Database and start operation</h3>
<p>Copy /etc/virtuoso-opensource-6.1/virtuoso.ini to a fresh directory /myPATH/myNewVDir, change all file names to local ones</p>
<p><code>DatabaseFile                   = virtuoso.db</code> <code>ErrorLogFile                   = virtuoso.log</code> <code>LockFile                       = virtuoso.lck </code> <code>TransactionFile                = virtuoso.trx</code> <code>xa_persistent_file             = virtuoso.pxa</code> <code>DatabaseFile                   = virtuoso-temp.db</code> <code>TransactionFile                = virtuoso-temp.trx</code></p>
<p>change the ports 1111 (new, e.g. 1112) and 8890 (new, e.g. 8891) to different ones and start a new daemon with</p>
<p><code>cd /myPATH/myNewVDir; virtuoso-t +configfile virtuoso.ini </code></p>
<p>This will generate all additional files in that directory and start the daemon. Access the database via console</p>
<p><code>isql-vt 1112 dba dba</code></p>
<p>and first change the default password 'dba'</p>
<p><code>SQL&gt; set password dba YourVerySecretPassword ;</code></p>
<p>The web front end to the new database will be available at <a href="http://localhost:8891">http://localhost:8891</a>.</p>
<p>Shut down the service from the console with</p>
<p><code>isql-vt 1112 dba YourVerySecretPassword</code> <code>SQL&gt; shutdown() ;</code></p>
<h3 id="optional-install-ontowiki">(Optional) Install Ontowiki</h3>
<p>Ontowiki is a pure PHP application, that runs completely within the apache web server and can be configured by various plugins.</p>
<p>Ontowiki requires apache with php5 support. To operate with Virtuoso the php5-odbc extension has to be installed.</p>
<p><code>sudo apt-get install php5-odbc php5 libapache2-mod-php5</code></p>
<p>hgg, 2014-01-09: We get reported for ubuntu 13.10, that 'php-json' is put (by legal restrictions) into a separate package and is required to be installed additionally.</p>
<p>The database service has to be be registered with ODBC. Add a section</p>
<p><code> # Symbolicdata OntoWiki dsn start</code> <code> [SDOW]</code> <code> Description=Symbolicdata OntoWiki Virtuoso DSN</code> <code> Driver=/usr/lib/odbc/virtodbc.so</code> <code> Address=localhost:1111</code> <code> # Symbolicdata OntoWiki dsn end</code></p>
<p>with a unique section name [SDOW] and the DBPort to the /etc/odbc.ini file.</p>
<p>hgg, 2013-07-22: I had a problem if the the port is not 1111, OntoWiki was installed under the default port instead of the port given here.</p>
<p>To run Ontowiki requires Apache with php5 and mod_rewrite enabled. A typical configuration in apache2/sites-enabled looks as follows:</p>
<p><code> DocumentRoot /home/web/public_html</code> <code> </code><Directory /home/web/public_html/> <code>   Options Indexes FollowSymLinks MultiViews</code> <code>   AllowOverride All </code> <code>   Order allow,deny</code> <code>   Allow from all</code> <code> </code></Directory></p>
<p>We recommend to deploy one Ontowiki instance per application.</p>
<p>We describe the main steps to deploy Ontowiki. See <a href="https://github.com/AKSW/OntoWiki/wiki/GetOntowikiUsers">https://github.com/AKSW/OntoWiki/wiki/GetOntowikiUsers</a> for details.</p>
<ul>
<li>Clone Ontowiki from the github repo to the target directory</li>
</ul>
<p><code> git clone </code><a href="https://github.com/AKSW/OntoWiki.git"><code>https://github.com/AKSW/OntoWiki.git</code></a></p>
<ul>
<li>Change to that directory and load the additional libraries Erfurt, RDFAuthor and Zend</li>
</ul>
<p><code> make deploy</code></p>
<ul>
<li>Copy config.ini.sample to config.ini and adapt it. Note that values in config.ini overwrite standard settings in various other ini files.
<ul>
<li>store.virtuoso.dsn - Put here the section head of the Virtuoso store from odbc.ini (without quotes)</li>
<li>store.virtuoso.user - The Virtuoso store user (default dba)</li>
<li>store.virtuoso.password - Password of the Virtuoso store</li>
</ul></li>
<li>Link the directory to a directory /WebDir that is delivered by the web server.</li>
<li>Direct your browser to <a href="http://localhost/WebDir">http://localhost/WebDir</a>
<ul>
<li>Test if <a href="http://localhost/WebDir/config.ini">http://localhost/WebDir/config.ini</a> is delivered. It shouldn't, sinde this is forbidded by the .htaccess file in /WebDir, that was pulled from the repo. Note that functioning mod_rewrite and the content of .htaccess are essential for Ontowiki since they provide all the URI rewrite magics required in the Linked Data standards.</li>
<li>Now you can login as Superadmin with login/passwd of the Virtuoso, configure users and user rights and manage rdf data files via OntoWiki.</li>
</ul></li>
<li>For best practises using a Virtuoso based OntoWiki see <a href="Using.Ontowiki" title="wikilink">Using.Ontowiki</a>.</li>
</ul>
<p><strong>Security warning:</strong> In the current default installation (as of 2013-11-09, present also in 2014-03-01) the preconfigured <em>Admin</em> account has no password set and the <em>Anonymous</em> account has write access to all ontologies. This should be changed for an non local OntoWiki installation.</p>
<h3 id="data-management">Data Management</h3>
<p>To load SD data from the files supplied with the git repo directly into the Virtuoso engine the following steps are required:</p>
<ol style="list-style-type: decimal">
<li>Check out the repo to /YourPathTo/symbolicdata, add the path /YourPathTo/symbolicdata to the data part of the distribution to the DirsAllowed</li>
</ol>
<p><code>DirsAllowed =., /usr/share/virtuoso-opensource-6.1/vad, /YourPathTo/symbolicdata</code></p>
<p>and restart the daemon. Set up the environment variable SD:</p>
<p><code> export SD=/YourPathTo/symbolicdata</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Load all turtle graphs into the Virtuoso Engine. The perl script at <code>src/vsql/loaddata.pl</code> writes the required output to stdout, that contains a number of records like</li>
</ol>
<p><code> sparql create silent graph </code><a href="http://symbolicdata.org/Data/People/">http://symbolicdata.org/Data/People/</a><code> ; </code> <code> DB.DBA.TTLP_MT (file_to_string_output('/YourPathTo/symbolicdata/data/RDFData/People.ttl'),'</code><a href="http://symbolicdata.org/Data/People/"><code>http://symbolicdata.org/Data/People/</code></a><code>'); </code></p>
<p>Read that into Virtuoso using the command line tool <code>isql-vt</code>:</p>
<p><code> perl loaddata.pl | isql-vt 1111 dba YourVerySecretPassword</code></p>
<ol start="3" style="list-style-type: decimal">
<li>Check success from within the console</li>
</ol>
<p><code> isql-vt 1111 dba YourVerySecretPassword</code> <code> SQL&gt; sparql select distinct ?s from </code><a href="http://symbolicdata.org/Data/People/">http://symbolicdata.org/Data/People/</a><code> where {?s ?p ?o};</code></p>
<p>and similar for the other graphs 'Bibliography', 'PolynomialSystems', 'Systems' etc. The command will list you the URIs of all instances in the given graph. Try the same at the Sparql endpoint <a href="http://localhost:8890/sparql">http://localhost:8890/sparql</a> with</p>
<p><code> select distinct ?s from </code><a href="http://symbolicdata.org/Data/People/">http://symbolicdata.org/Data/People/</a><code> where {?s ?p ?o}</code></p>
<p>It should list the URIs of all people stored in the SD People knowledge base. Compare your output with that from <a href="http://symbolicdata.org:8890/sparql">http://symbolicdata.org:8890/sparql</a></p>
<h3 id="additional-remarks-about-virtuoso">Additional remarks about Virtuoso</h3>
<h4 id="more-on-config.ini">More on config.ini</h4>
<p>Adapt at least the items ServerPort in the Parameters section (default 1111), the ServerPort in the HTTPSection (default 8890) and the DirsAllowed. <strong>Different databases have to use different ports.</strong></p>
<p><strong>DirsAllowed</strong> contains a comma separated list of all directories where the service is allowed to read files. A file location in any subdirectory of the listed directories will be accepted. It is recommended to use absolute path names without file symlinks.</p>
<h4 id="change-the-password">Change the Password</h4>
<p>Open the console</p>
<p><code>isql-v </code><DBServerPort><code> dba </code><passwd></p>
<p>and change the password (standard user = dba, passwd = dba)</p>
<p><code>set password </code><old password><code> </code><new password><code>;</code></p>
<p>For curious people: Direct your Browser to <a href="http://localhost:8890">http://localhost:8890</a>. It will show you the Virtuoso VSP pages with a &quot;phpmyadmin&quot; like administration web frontend at <a href="http://localhost:8890/conductor">http://localhost:8890/conductor</a>. Not required for beginners.</p>
<h4 id="some-useful-commands">Some useful commands</h4>
<p>Shutdown the service from the console with</p>
<p><code> SQL&gt; shutdown() ;</code></p>
<p>Clear Data from a given graph:</p>
<p><code> SQL&gt; sparql clear graph </code><a href="http://symbolicdata.org/Data/Annotations/">http://symbolicdata.org/Data/Annotations/</a><code> ; </code></p>
<p>Graphs are not created automatically. If you have problems to display content in Ontowiki, a command as the following may help to resolve the trouble</p>
<p><code> SQL&gt; sparql create silent graph </code><a href="http://symbolicdata.org/Data/Bibliography/">http://symbolicdata.org/Data/Bibliography/</a><code> ;</code></p>
